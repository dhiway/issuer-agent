"use strict";
/* eslint-disable import/prefer-default-export */
/**
 * @packageDocumentation
 * @module DataUtils
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.verifyIsHex = exports.isHex = exports.isCordAddress = exports.verifyCordAddress = exports.validateId = void 0;
const tslib_1 = require("tslib");
/**
 * Dummy comment needed for correct doc display, do not remove.
 */
const util_1 = require("@polkadot/util");
const util_crypto_1 = require("@polkadot/util-crypto");
const SDKErrors = tslib_1.__importStar(require("./SDKErrors.js"));
const Identifier_js_1 = require("./Identifier.js");
const ss58Format_js_1 = require("./ss58Format.js");
/**
 *  Validates the format of the given blake2b hash via regex.
 *
 * @param hash Hash string to validate for correct Format.
 * @param name Contextual name of the address, e.g. "stream owner".
 * @throws [[ERROR_HASH_TYPE]] when hash not of type string or of invalid Format.
 *
 * @returns Boolean whether the given hash string checks out against the Format.
 */
function validateId(id, name) {
    if (typeof id !== 'string') {
        throw new SDKErrors.IdentifierInvalidError(id);
    }
    if (!(0, Identifier_js_1.checkIdentifier)(id)) {
        throw new SDKErrors.IdentifierInvalidError(id);
    }
    return true;
}
exports.validateId = validateId;
/**
 * Verifies a given address string against the External Address Format (SS58) with our Prefix of 29.
 *
 * @param input Address string to validate for correct Format.
 */
function verifyCordAddress(input) {
    if (typeof input !== 'string') {
        throw new SDKErrors.AddressTypeError();
    }
    if (!(0, util_crypto_1.checkAddress)(input, ss58Format_js_1.ss58Format)[0]) {
        throw new SDKErrors.AddressInvalidError(input);
    }
}
exports.verifyCordAddress = verifyCordAddress;
/**
 * Type guard to check whether input is an SS58 address with our prefix of 29.
 *
 * @param input Address string to validate for correct format.
 * @returns True if input is a CordAddress, false otherwise.
 */
function isCordAddress(input) {
    try {
        verifyCordAddress(input);
        return true;
    }
    catch {
        return false;
    }
}
exports.isCordAddress = isCordAddress;
// re-exporting isHex
var util_2 = require("@polkadot/util");
Object.defineProperty(exports, "isHex", { enumerable: true, get: function () { return util_2.isHex; } });
/**
 * Validates the format of a hex string via regex.
 *
 * @param input Hex string to validate for correct format.
 * @param bitLength Expected length of hex in bits.
 */
function verifyIsHex(input, bitLength) {
    if (!(0, util_1.isHex)(input, bitLength)) {
        throw new SDKErrors.HashMalformedError(typeof input === 'string' ? input : undefined);
    }
}
exports.verifyIsHex = verifyIsHex;
